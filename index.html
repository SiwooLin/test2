<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>RIMOâ€™S SONG BOOK</title>
<link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet" />
<style>
  /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
  body {
    margin: 0;
    background-color: #000;
    color: #fff;
    font-family: 'Jua', sans-serif;
    text-align: center;
    padding: 40px 20px 60px;
    box-sizing: border-box;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 {
    font-size: 32px;
    margin-bottom: 8px;
    color: #ff6f00;
    cursor: pointer;
  }
  .headlineNotice {
    font-size: 15px;
    margin-bottom: 24px;
    color: #ff6f00;
    max-width: 700px;
  }
  input[type="text"], select {
    width: 100%;
    max-width: 500px;
    padding: 12px;
    font-size: 16px;
    border: none;
    border-radius: 999px;
    background-color: #111;
    color: #fff;
    box-shadow: 0 0 8px #ff6f00;
    outline: none;
    text-align: center;
    margin-bottom: 20px;
    box-sizing: border-box;
  }
  input[type="text"]:focus, select:focus {
    box-shadow: 0 0 12px #8e44ad;
  }
  button {
    padding: 8px 16px;
    font-size: 14px;
    background-color: #111;
    color: #fff;
    border-radius: 20px;
    cursor: pointer;
    margin: 5px;
    border: 1px solid #8e44ad;
    user-select: none;
    transition: background-color 0.3s, color 0.3s;
  }
  button:hover {
    background-color: #8e44ad;
  }
  .orange-btn {
    border-color: #ff6f00;
    color: #ff6f00;
  }
  .orange-btn:hover {
    background-color: #ff6f00;
    color: #111;
  }
  .active-btn {
    background-color: #ff6f00 !important;
    color: #111 !important;
    border-color: #ff6f00 !important;
  }
  .section {
    background-color: #111;
    border: 1px solid #8e44ad;
    box-shadow: 0 0 8px #8e44ad;
    border-radius: 12px;
    padding: 20px;
    margin-top: 20px;
    font-size: 14px;
    line-height: 1.6;
    white-space: pre-line;
    text-align: left;
    max-width: 700px;
    width: 100%;
  }
  table {
    width: 100%;
    max-width: 700px;
    margin: 20px auto 0;
    border-collapse: collapse;
    font-size: 14px;
  }
  th, td {
    padding: 12px;
    border: 1px solid #8e44ad;
    text-align: center;
  }
  th {
    background-color: #1a1a1a;
  }
  tr:nth-child(even) {
    background-color: #1a1a1a;
  }
  tr:nth-child(odd) {
    background-color: #2a2a2a;
  }
  #noResult {
    display: none;
    color: #ff6f00;
    margin-top: 20px;
    font-size: 15px;
    max-width: 700px;
  }
  #categorySelector, #initialButtons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
    margin-top: 10px;
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
  }
  /* ê´€ë¦¬ì ëª¨ë“œ ì „ìš© ì˜ì—­ */
  #adminSection {
    display: none;
    background-color: #111;
    border: 1px solid #8e44ad;
    box-shadow: 0 0 8px #8e44ad;
    border-radius: 12px;
    padding: 20px;
    margin-top: 20px;
    font-size: 14px;
    line-height: 1.6;
    white-space: pre-line;
    max-width: 700px;
    width: 100%;
    text-align: left;
  }
  #adminSection h2 {
    color: #ff6f00;
    margin-bottom: 12px;
    text-align: center;
  }
  #adminForm label {
    font-weight: bold;
    margin-top: 12px;
    display: block;
    color: #ff6f00;
  }
  #adminForm input[type="text"], #adminForm select {
    width: 100%;
    margin-top: 4px;
  }
  #adminForm button {
    margin-top: 12px;
    width: auto;
  }
  #adminFormControls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 15px;
  }
  #adminExitBtn {
    margin-left: 12px;
    background-color: #ff6f00;
    color: #111;
    border-color: #ff6f00;
    border-radius: 12px;
    padding: 8px 16px;
  }
  #adminExitBtn:hover {
    background-color: #e65c00;
  }
  /* ê´€ë¦¬ì ëª¨ë“œ ì§„ì… ë²„íŠ¼ ìš°ì¸¡ ìƒë‹¨ ê³ ì • */
  #adminToggleBtn {
    position: fixed;
    top: 16px;
    right: 16px;
    z-index: 1000;
  }
  /* ì‚­ì œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
  .delete-btn {
    background-color: #aa2222;
    color: #fff;
    border-radius: 12px;
    padding: 6px 12px;
    border: none;
    cursor: pointer;
  }
  .delete-btn:hover {
    background-color: #880000;
  }

  /* í–‰ í´ë¦­ì‹œ ë§ˆìš°ìŠ¤ ì»¤ì„œ */
  #adminSongsTable tbody tr {
    cursor: pointer;
  }
  /* ëª¨ë‹¬ ë°°ê²½ */
  #passwordModalOverlay {
    display: none;
    position: fixed;
    z-index: 2000;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.7);
    justify-content: center;
    align-items: center;
  }
  #passwordModal {
    background: #111;
    border: 2px solid #ff6f00;
    border-radius: 12px;
    padding: 20px 30px;
    text-align: center;
    max-width: 320px;
    width: 90%;
    box-shadow: 0 0 12px #ff6f00;
  }
  #passwordModal input[type="password"] {
    width: 100%;
    padding: 10px;
    font-size: 18px;
    border-radius: 8px;
    border: none;
    margin-top: 15px;
    background: #222;
    color: #fff;
    box-sizing: border-box;
    outline: none;
    text-align: center;
  }
  #passwordModal button {
    margin-top: 15px;
    width: 100%;
    background-color: #ff6f00;
    border: none;
    color: #111;
    font-weight: bold;
    font-size: 16px;
    border-radius: 12px;
    cursor: pointer;
  }
  #passwordModal button:hover {
    background-color: #e65c00;
  }
  #passwordError {
    margin-top: 10px;
    color: #ff5555;
    font-weight: bold;
    display: none;
  }
</style>
</head>
<body>

<h1 id="title" onclick="showSection('manual')">RIMOâ€™S SONG BOOK</h1>

<p class="headlineNotice">ğŸ“Œ ë…¸ë˜ì±… ì„¤ëª…ì„œì™€ ê°€ê²©í‘œë¥¼ ë¨¼ì € í™•ì¸í•˜ê³  ì´ìš©í•´ì£¼ì„¸ìš”!</p>

<input type="text" id="searchInput" placeholder="ê°€ìˆ˜ / ì œëª© ê²€ìƒ‰" oninput="handleSearch()" style="display:none;" />

<div>
  <button onclick="showSection('manual')">ë…¸ë˜ì±… ì„¤ëª…ì„œ</button>
  <button onclick="showSection('price')">ê°€ê²©í‘œ</button>
  <button onclick="showSection('songs')">ë…¸ë˜ëª©ë¡</button>
</div>

<!-- ì„¤ëª…ì„œ, ê°€ê²©í‘œ ì„¹ì…˜ -->
<div id="manual" class="section">
  â€¢ ë…¸ë˜ ì‹ ì²­ì„ í• ë• ê¼­!!! ê°€ìˆ˜ì™€ ê³¡ ì œëª©ì„ í•¨ê»˜ ì ì–´ì„œ ì‹ ì²­í•´ì£¼ì„¸ìš”.
  (ì½”ë“œë„ ì ì–´ì£¼ì‹œë©´ ê°ì‚¬í•©ë‹ˆë‹¤!)<br/>
  â€¢ ì»¨ë””ì…˜ì— ë”°ë¼ ë¶€ë¥´ê¸° ì–´ë µë‹¤ê³  íŒë‹¨ ë  ê²½ìš° ì‹ ì²­ê³¡ì„ ê±°ì ˆ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
  (ê±°ì ˆ ë‹¹í•œ ì‹ ì²­ì€ ê¸°ë³¸ ë…¸ë˜ 2ê³¡ìœ¼ë¡œ ëŒ€ì²´ ê°€ëŠ¥ í•©ë‹ˆë‹¤.)<br/>
  â€¢ ì„¤ëª…ì„ ì½ì§€ ì•Šê³  ì‹ ì²­í•  ê²½ìš° ì±…ì„ì€ ì‹ ì²­ìì—ê²Œ ìˆìŠµë‹ˆë‹¤.<br/>
  â€¢ ì¶”ì²œ ê³¡ì€ ë””ìŠ¤ì½”ë“œ ë…¸ë˜ ì¶”ì²œë°©ì— ì ì–´ì£¼ì„¸ìš”.<br/><br/>
  âŒ ê³¼ë„í•œ í‰ê°€ì™€ í›ˆìˆ˜ëŠ” ìì œ í•´ì£¼ì„¸ìš” âŒ
</div>

<div id="price" class="section" style="display:none;">
  â€¢ ê¸°ë³¸ ë…¸ë˜ ì‹ ì²­ì€ 2000ì¹˜ì¦ˆ í˜¹ì€ íˆ¬ë„¤ì´ì…˜ìœ¼ë¡œ ì‹ ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br/>
  â€¢ ì–´ë ¤ìš´ ë…¸ë˜ ì‹ ì²­ì€ 5000ì¹˜ì¦ˆ í˜¹ì€ íˆ¬ë„¤ì´ì…˜ìœ¼ë¡œ ì‹ ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br/>
  â€¢ ìœ ë£Œê³¡ ë…¸ë˜ ì‹ ì²­ì€ 10000ì¹˜ì¦ˆ ì´ìƒ í˜¹ì€ íˆ¬ë„¤ì´ì…˜ìœ¼ë¡œ ì‹ ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br/>
  â€¢ ê°œì¸ ì†Œì¥ ë…¸ë˜ ë…¹ìŒë³¸ (ë¯¹ì‹± ìœ ë¬´ ì„ íƒ ê°€ëŠ¥)ì€ 200,000ì¹˜ì¦ˆ í˜¹ì€ íˆ¬ë„¤ì´ì…˜ìœ¼ë¡œ ì‹ ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤.
</div>

<!-- ë…¸ë˜ ëª©ë¡ ì„¹ì…˜ -->
<div id="songs" class="section" style="display:none; text-align:center;">
  <!-- ì¹´í…Œê³ ë¦¬ ì„ íƒ ë²„íŠ¼ -->
  <div id="categorySelector">
    <button class="orange-btn active-btn" onclick="selectCategory('ì „ì²´')" id="cat-btn-ì „ì²´">ì „ì²´</button>
    <button class="orange-btn" onclick="selectCategory('Kpop')" id="cat-btn-Kpop">K-pop</button>
    <button class="orange-btn" onclick="selectCategory('Kpop ì•„ì´ëŒ')" id="cat-btn-Kpop ì•„ì´ëŒ">K-pop ì•„ì´ëŒ</button>
    <button class="orange-btn" onclick="selectCategory('Pop')" id="cat-btn-Pop">Pop</button>
  </div>

  <!-- ì´ë‹ˆì…œ ë²„íŠ¼ -->
  <div id="initialButtons" style="margin-top: 15px;"></div>
</div>

<!-- ë…¸ë˜ í…Œì´ë¸” -->
<table id="songTable" style="display:none;">
  <thead>
    <tr><th>ê°€ìˆ˜</th><th>ì œëª©</th><th>ì½”ë“œ</th><th>ë‚œì´ë„</th><th>ìˆ™ë ¨ë„</th></tr>
  </thead>
  <tbody id="songList"></tbody>
</table>

<p id="noResult">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ì¶”ì²œ ê³¡ì€ ë””ìŠ¤ì½”ë“œ ë…¸ë˜ ì¶”ì²œë°©ì— ì ì–´ì£¼ì„¸ìš”.</p>

<!-- ê´€ë¦¬ì ëª¨ë“œ ì§„ì… ë²„íŠ¼ (ìš°ì¸¡ ìƒë‹¨ ê³ ì •) -->
<button id="adminToggleBtn" onclick="openPasswordModal()">ê´€ë¦¬ì ëª¨ë“œ</button>

<!-- ê´€ë¦¬ì ëª¨ë“œ ì„¹ì…˜ -->
<div id="adminSection">
  <h2>ê´€ë¦¬ì ëª¨ë“œ - ë…¸ë˜ ìˆ˜ì • ë° ì¶”ê°€</h2>

  <!-- ê´€ë¦¬ì ê²€ìƒ‰ì°½ -->
  <input type="text" id="adminSearchInput" placeholder="ê°€ìˆ˜ ë˜ëŠ” ì œëª© ê²€ìƒ‰" oninput="filterAdminSongs()" style="margin-bottom: 15px;" />

  <form id="adminForm" onsubmit="event.preventDefault(); addOrUpdateSong();">
    <label for="adminCategory">ì¹´í…Œê³ ë¦¬</label>
    <select id="adminCategory" required>
      <option value="Kpop">Kpop</option>
      <option value="Kpop ì•„ì´ëŒ">Kpop ì•„ì´ëŒ</option>
      <option value="Pop">Pop</option>
    </select>

    <label for="adminInitial">ì´ˆì„± (í•œê¸€ ë˜ëŠ” ì˜ë¬¸ ëŒ€ë¬¸ì)</label>
    <select id="adminInitial" required></select>

    <label for="adminSinger">ê°€ìˆ˜</label>
    <input type="text" id="adminSinger" required />

    <label for="adminTitle">ì œëª©</label>
    <input type="text" id="adminTitle" required />

    <label for="adminKey">ì½”ë“œ</label>
    <input type="text" id="adminKey" />

    <label for="adminDifficulty">ë‚œì´ë„</label>
    <input type="text" id="adminDifficulty" />

    <label for="adminSkill">ìˆ™ë ¨ë„</label>
    <input type="text" id="adminSkill" />

    <div id="adminFormControls">
      <button type="submit">ì¶”ê°€ / ìˆ˜ì • ì €ì¥</button>
      <button type="button" id="adminExitBtn" onclick="toggleAdminMode()">ê´€ë¦¬ì ëª¨ë“œ ì¢…ë£Œ</button>
    </div>
  </form>

  <table id="adminSongsTable">
    <thead>
      <tr><th>ì¹´í…Œê³ ë¦¬</th><th>ì´ˆì„±</th><th>ê°€ìˆ˜</th><th>ì œëª©</th><th>ì½”ë“œ</th><th>ë‚œì´ë„</th><th>ìˆ™ë ¨ë„</th><th>ì‚­ì œ</th></tr>
    </thead>
    <tbody id="adminSongList"></tbody>
  </table>
</div>

<!-- ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ëª¨ë‹¬ -->
<div id="passwordModalOverlay">
  <div id="passwordModal">
    <h3>ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</h3>
    <input type="password" id="adminPasswordInput" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" autofocus />
    <button onclick="checkPassword()">í™•ì¸</button>
    <p id="passwordError">ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.</p>
  </div>
</div>

<script>
  // ë…¸ë˜ ë°ì´í„° ì´ˆê¸°
  let songs = [
    {category:'Kpop ì•„ì´ëŒ', initial:'ã…‹', singer:'íë”ë¸”ìœ ì´ì•Œ(QWER)', title:'ê°€ì§œì•„ì´ëŒ', key:'Fm', difficulty:'', skill:'ì™„ë²½ ì¹´í”¼X'},
    {category:'Kpop', initial:'ã…‡', singer:'ì•„ì´ìœ ', title:'ë°¤í¸ì§€', key:'C', difficulty:'í•˜', skill:'ìƒ'},
    {category:'Pop', initial:'A', singer:'Adele', title:'Hello', key:'Am', difficulty:'ìƒ', skill:'ìƒ'},
    {category:'Kpop ì•„ì´ëŒ', initial:'ã…‡', singer:'ì˜¤ë§ˆì´ê±¸', title:'Dun Dun Dance', key:'E', difficulty:'ì¤‘', skill:'ì¤‘'},
    {category:'Kpop', initial:'ã„´', singer:'ë‰´ì§„ìŠ¤', title:'Hype Boy', key:'D', difficulty:'ì¤‘', skill:'ì¤‘'},
    {category:'Kpop ì•„ì´ëŒ', initial:'ã…‚', singer:'ë°©íƒ„ì†Œë…„ë‹¨', title:'Dynamite', key:'G', difficulty:'ì¤‘', skill:'ì¤‘'},
  ];

  // ìƒíƒœê°’
  let currentCategory = 'ì „ì²´';
  let currentInitial = 'ì „ì²´';
  let adminMode = false;
  let editingIndex = -1;

  // DOM ìš”ì†Œ
  const songTable = document.getElementById("songTable");
  const songList = document.getElementById("songList");
  const noResult = document.getElementById("noResult");
  const initialButtonsDiv = document.getElementById("initialButtons");
  const categorySelector = document.getElementById("categorySelector");
  const searchInput = document.getElementById("searchInput");

  const adminSection = document.getElementById("adminSection");
  const adminSearchInput = document.getElementById("adminSearchInput");
  const adminCategory = document.getElementById("adminCategory");
  const adminInitial = document.getElementById("adminInitial");
  const adminSinger = document.getElementById("adminSinger");
  const adminTitle = document.getElementById("adminTitle");
  const adminKey = document.getElementById("adminKey");
  const adminDifficulty = document.getElementById("adminDifficulty");
  const adminSkill = document.getElementById("adminSkill");
  const adminSongList = document.getElementById("adminSongList");

  const adminToggleBtn = document.getElementById("adminToggleBtn");

  // ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ ê´€ë ¨
  const passwordModalOverlay = document.getElementById("passwordModalOverlay");
  const adminPasswordInput = document.getElementById("adminPasswordInput");
  const passwordError = document.getElementById("passwordError");
  const ADMIN_PASSWORD = "admin123"; // ê¸°ë³¸ ë¹„ë°€ë²ˆí˜¸, í•„ìš”ì‹œ ë³€ê²½ ê°€ëŠ¥

  // í•œê¸€ ì´ˆì„± ë¦¬ìŠ¤íŠ¸ ì „ì²´ (ê¸°íƒ€ ì œì™¸)
  const allChosung = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
  // ì˜ì–´ ì•ŒíŒŒë²³ ëŒ€ë¬¸ì A~Z
  const allAlpha = Array.from(Array(26)).map((_,i)=>String.fromCharCode(65+i));

  // =============== ì´ˆê¸° í•¨ìˆ˜ ì‹¤í–‰ ===============
  showSection('manual'); // ê¸°ë³¸ ì„¤ëª…ì„œ ë³´ì—¬ì£¼ê¸°
  generateInitialButtons();
  populateAdminInitialSelect();

  // =================== ë…¸ë˜ì±… ë©”ì¸ ===================
  function showSection(sectionId) {
    ['manual','price','songs'].forEach(id => {
      document.getElementById(id).style.display = (id === sectionId) ? 'block' : 'none';
    });
    if(sectionId === 'songs') {
      searchInput.style.display = 'block';
      categorySelector.style.display = 'flex';
      initialButtonsDiv.style.display = 'flex';
      songTable.style.display = 'none';
      noResult.style.display = 'none';

      // ì´ˆê¸°í™”
      currentCategory = 'ì „ì²´';
      currentInitial = 'ì „ì²´';
      updateCategoryButtons();
      updateInitialButtons();
      filterAndRenderSongs();
    } else {
      searchInput.style.display = 'none';
      categorySelector.style.display = 'none';
      initialButtonsDiv.style.display = 'none';
      songTable.style.display = 'none';
      noResult.style.display = 'none';
    }
  }

  function updateCategoryButtons() {
    ['ì „ì²´','Kpop','Kpop ì•„ì´ëŒ','Pop'].forEach(cat => {
      const btn = document.getElementById(`cat-btn-${cat}`);
      if(btn) btn.classList.toggle('active-btn', cat === currentCategory);
    });
  }

  // ì´ë‹ˆì…œ ë²„íŠ¼ ìƒì„±
  function generateInitialButtons() {
    initialButtonsDiv.innerHTML = '';

    const allBtn = document.createElement('button');
    allBtn.textContent = 'ì „ì²´';
    allBtn.className = 'orange-btn';
    if(currentInitial === 'ì „ì²´') allBtn.classList.add('active-btn');
    allBtn.onclick = () => {
      currentInitial = 'ì „ì²´';
      updateInitialButtons();
      filterAndRenderSongs();
    };
    initialButtonsDiv.appendChild(allBtn);

    allChosung.forEach(ch => {
      const btn = document.createElement('button');
      btn.textContent = ch;
      btn.className = 'orange-btn';
      if(currentInitial === ch) btn.classList.add('active-btn');
      btn.onclick = () => {
        currentInitial = ch;
        updateInitialButtons();
        filterAndRenderSongs();
      };
      initialButtonsDiv.appendChild(btn);
    });

    allAlpha.forEach(ch => {
      const btn = document.createElement('button');
      btn.textContent = ch;
      btn.className = 'orange-btn';
      if(currentInitial === ch) btn.classList.add('active-btn');
      btn.onclick = () => {
        currentInitial = ch;
        updateInitialButtons();
        filterAndRenderSongs();
      };
      initialButtonsDiv.appendChild(btn);
    });
  }

  function updateInitialButtons() {
    Array.from(initialButtonsDiv.children).forEach(btn => {
      btn.classList.toggle('active-btn', btn.textContent === currentInitial);
    });
  }

  // ì¹´í…Œê³ ë¦¬ ì„ íƒ
  function selectCategory(cat) {
    currentCategory = cat;
    updateCategoryButtons();
    generateInitialButtons();
    currentInitial = 'ì „ì²´';
    updateInitialButtons();
    filterAndRenderSongs();
  }

  // í•„í„°ë§ ë° ë Œë”ë§
  function filterAndRenderSongs() {
    let keyword = searchInput.value.trim().toLowerCase();
    let filtered = songs.filter(song => {
      if(currentCategory !== 'ì „ì²´' && song.category !== currentCategory) return false;
      if(currentInitial !== 'ì „ì²´' && song.initial !== currentInitial) return false;
      if(keyword !== '') {
        const match = song.singer.toLowerCase().includes(keyword) || song.title.toLowerCase().includes(keyword);
        if(!match) return false;
      }
      return true;
    });

    if(filtered.length === 0) {
      songTable.style.display = 'none';
      noResult.style.display = 'block';
    } else {
      noResult.style.display = 'none';
      songTable.style.display = 'table';
      renderSongTable(filtered);
    }
  }

  function renderSongTable(list) {
    songList.innerHTML = '';
    list.forEach(song => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${song.singer}</td><td>${song.title}</td><td>${song.key}</td><td>${song.difficulty}</td><td>${song.skill}</td>`;
      songList.appendChild(tr);
    });
  }

  function handleSearch() {
    filterAndRenderSongs();
  }

  // =================== ê´€ë¦¬ì ëª¨ë“œ ===================

  // ëª¨ë‹¬ ì—´ê¸°
  function openPasswordModal() {
    adminPasswordInput.value = '';
    passwordError.style.display = 'none';
    passwordModalOverlay.style.display = 'flex';
    adminPasswordInput.focus();
  }

  // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
  function checkPassword() {
    const input = adminPasswordInput.value;
    if(input === ADMIN_PASSWORD) {
      passwordModalOverlay.style.display = 'none';
      toggleAdminMode(true);
    } else {
      passwordError.style.display = 'block';
      adminPasswordInput.focus();
    }
  }

  // ê´€ë¦¬ì ëª¨ë“œ í† ê¸€
  function toggleAdminMode(forceOn = null) {
    if(forceOn === true || (forceOn === null && !adminMode)) {
      adminMode = true;
      adminSection.style.display = 'block';
      adminToggleBtn.style.display = 'none';
      searchInput.style.display = 'block';
      categorySelector.style.display = 'none';
      initialButtonsDiv.style.display = 'none';
      document.querySelector('.headlineNotice').style.display = 'none'; // ì„¤ëª…ì„œ/ê°€ê²©í‘œ ìˆ¨ê¹€

      showSection('songs');
      renderAdminSongTable();
    } else {
      adminMode = false;
      adminSection.style.display = 'none';
      adminToggleBtn.style.display = 'inline-block';
      searchInput.style.display = 'block';
      categorySelector.style.display = 'flex';
      initialButtonsDiv.style.display = 'flex';
      document.querySelector('.headlineNotice').style.display = 'block'; // ì„¤ëª…ì„œ/ê°€ê²©í‘œ ë³´ì„

      clearAdminForm();
      filterAndRenderSongs();
    }
  }

  // ê´€ë¦¬ì ì´ë‹ˆì…œ select ì±„ìš°ê¸° (ê¸°íƒ€ ì œì™¸)
  function populateAdminInitialSelect() {
    adminInitial.innerHTML = '';
    // í•œê¸€ ì´ˆì„±
    allChosung.forEach(ch => {
      const option = document.createElement('option');
      option.value = ch;
      option.textContent = ch;
      adminInitial.appendChild(option);
    });
    // ì˜ì–´ ëŒ€ë¬¸ì
    allAlpha.forEach(ch => {
      const option = document.createElement('option');
      option.value = ch;
      option.textContent = ch;
      adminInitial.appendChild(option);
    });
  }

  // ê´€ë¦¬ì í…Œì´ë¸” ë Œë”ë§
  function renderAdminSongTable() {
    adminSongList.innerHTML = '';
    songs.forEach((song, idx) => {
      const tr = document.createElement('tr');
      tr.onclick = () => {
        fillAdminForm(idx);
      };
      tr.innerHTML = `
        <td>${song.category}</td>
        <td>${song.initial}</td>
        <td>${song.singer}</td>
        <td>${song.title}</td>
        <td>${song.key}</td>
        <td>${song.difficulty}</td>
        <td>${song.skill}</td>
        <td><button class="delete-btn" onclick="deleteSong(event, ${idx})">ì‚­ì œ</button></td>
      `;
      adminSongList.appendChild(tr);
    });
  }

  // ê´€ë¦¬ì ê²€ìƒ‰ í•„í„°
  function filterAdminSongs() {
    const keyword = adminSearchInput.value.trim().toLowerCase();
    const trs = adminSongList.children;
    for(let i = 0; i < trs.length; i++) {
      const tr = trs[i];
      const singer = tr.cells[2].textContent.toLowerCase();
      const title = tr.cells[3].textContent.toLowerCase();
      if(singer.includes(keyword) || title.includes(keyword)) {
        tr.style.display = '';
      } else {
        tr.style.display = 'none';
      }
    }
  }

  // ìˆ˜ì • í¼ì— ë°ì´í„° ì±„ìš°ê¸°
  function fillAdminForm(index) {
    editingIndex = index;
    const s = songs[index];
    adminCategory.value = s.category;
    adminInitial.value = s.initial || allChosung[0];
    adminSinger.value = s.singer;
    adminTitle.value = s.title;
    adminKey.value = s.key;
    adminDifficulty.value = s.difficulty;
    adminSkill.value = s.skill;
  }

  // í¼ ì´ˆê¸°í™”
  function clearAdminForm() {
    editingIndex = -1;
    adminCategory.value = 'Kpop';
    adminInitial.value = allChosung[0];
    adminSinger.value = '';
    adminTitle.value = '';
    adminKey.value = '';
    adminDifficulty.value = '';
    adminSkill.value = '';
    adminSearchInput.value = '';
  }

  // ì¶”ê°€/ìˆ˜ì • ì €ì¥
  function addOrUpdateSong() {
    const newSong = {
      category: adminCategory.value,
      initial: adminInitial.value,
      singer: adminSinger.value.trim(),
      title: adminTitle.value.trim(),
      key: adminKey.value.trim(),
      difficulty: adminDifficulty.value.trim(),
      skill: adminSkill.value.trim()
    };
    if(!newSong.singer || !newSong.title) {
      alert('ê°€ìˆ˜ì™€ ì œëª©ì€ í•„ìˆ˜ ì…ë ¥ì…ë‹ˆë‹¤.');
      return;
    }

    if(editingIndex >= 0) {
      songs[editingIndex] = newSong;
    } else {
      songs.push(newSong);
    }
    clearAdminForm();
    renderAdminSongTable();
    filterAndRenderSongs();
    alert('ì €ì¥ ì™„ë£Œ');
  }

  // ì‚­ì œ
  function deleteSong(event, idx) {
    event.stopPropagation();
    if(confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      songs.splice(idx, 1);
      renderAdminSongTable();
      filterAndRenderSongs();
      clearAdminForm();
    }
  }

  // ê´€ë¦¬ì ëª¨ë“œìš© ë…¸ë˜ í•„í„° (ê²€ìƒ‰)
  function filterAdminSongs() {
    const keyword = adminSearchInput.value.trim().toLowerCase();
    Array.from(adminSongList.children).forEach(tr => {
      const singer = tr.cells[2].textContent.toLowerCase();
      const title = tr.cells[3].textContent.toLowerCase();
      tr.style.display = (singer.includes(keyword) || title.includes(keyword)) ? '' : 'none';
    });
  }

</script>
</body>
</html>
