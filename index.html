<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RIMO’S SONG BOOK</title>
<link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet" />
<style>
  /* 화면 전체 중앙 정렬 */
  html, body {
    height: 100%;
    margin: 0; padding: 0;
    background: #000;
    color: #fff;
    font-family: 'Jua', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    user-select: none;
  }
  #container {
    max-width: 750px;
    width: 100%;
    padding: 30px;
    box-sizing: border-box;
    text-align: center;
  }
  h1#title {
    margin-bottom: 6px;
    color: #ff6f00;
    cursor: pointer;
  }
  .headlineNotice {
    margin-bottom: 24px;
    color: #ff6f00;
    user-select: none;
  }
  button {
    background: none;
    border: 2px solid #ff6f00;
    border-radius: 20px;
    color: #ff6f00;
    padding: 8px 16px;
    margin: 5px 8px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s, color 0.3s;
    user-select: none;
  }
  button:hover {
    background-color: #ff6f00;
    color: #111;
  }
  button.active {
    background-color: #ff6f00;
    color: #111;
  }
  input[type=text], select {
    font-family: 'Jua', sans-serif;
    font-size: 16px;
    padding: 8px 12px;
    border-radius: 999px;
    border: none;
    outline: none;
    background: #111;
    color: #fff;
    box-shadow: 0 0 8px #ff6f00;
    margin: 10px 0;
    max-width: 100%;
    text-align: center;
    user-select: text;
  }
  input[type=text]::placeholder {
    color: #bbb;
  }
  /* 관리자 토글 버튼 */
  #adminToggleBtn {
    position: fixed;
    top: 12px; right: 12px;
    background-color: #8e44ad;
    border: none;
    border-radius: 12px;
    padding: 10px 16px;
    font-weight: bold;
    color: #fff;
    cursor: pointer;
    user-select: none;
    box-shadow: 0 0 10px #8e44ad;
    z-index: 9999;
  }
  #adminToggleBtn:hover {
    background-color: #a461d9;
  }
  /* 관리자 영역 */
  #adminArea {
    background: #111;
    border: 2px solid #8e44ad;
    border-radius: 12px;
    box-shadow: 0 0 10px #8e44ad;
    margin-top: 30px;
    padding: 20px;
    display: none;
    text-align: left;
    user-select: text;
  }
  #adminForm {
    display: flex;
    flex-wrap: wrap;
    gap: 12px 20px;
    align-items: center;
    justify-content: center;
  }
  #adminForm label {
    color: #ff6f00;
    min-width: 80px;
    text-align: right;
    user-select: none;
  }
  #adminForm input, #adminForm select {
    max-width: 150px;
    width: 100%;
  }
  #adminButtons {
    margin-top: 15px;
    text-align: center;
  }
  #adminButtons button {
    min-width: 140px;
  }
  /* 기본 UI */
  #mainUI > div, #manual, #price, #songs {
    margin-top: 10px;
  }
  #manual, #price {
    background: #111;
    border: 2px solid #8e44ad;
    border-radius: 12px;
    padding: 20px;
    white-space: pre-line;
    text-align: left;
    font-size: 15px;
    user-select: text;
  }
  #categorySelector {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 15px;
    user-select: none;
  }
  #initialButtons {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 15px;
    user-select: none;
  }
  /* 노래 테이블 */
  table {
    width: 100%;
    border-collapse: collapse;
    user-select: none;
  }
  th, td {
    border: 1px solid #8e44ad;
    padding: 10px 8px;
    text-align: center;
  }
  th {
    background-color: #1a1a1a;
    color: #ff6f00;
  }
  tr:nth-child(even) {
    background-color: #222;
  }
  tr:nth-child(odd) {
    background-color: #333;
  }
  tr:hover {
    background-color: #444;
    cursor: pointer;
  }
  /* 검색 결과 없음 메시지 */
  #noResult, #adminNoResult {
    margin-top: 12px;
    font-size: 16px;
    color: #ff6f00;
    user-select: none;
  }
</style>
</head>
<body>
  <button id="adminToggleBtn" title="관리자 모드 전환">관리자 모드</button>

  <div id="container">
    <h1 id="title" title="홈으로 돌아가기">RIMO’S SONG BOOK</h1>
    <p class="headlineNotice">📌 노래책 설명서와 가격표를 먼저 확인하고 이용해주세요!</p>

    <div id="mainUI">
      <div>
        <button class="tab-btn active" data-section="manual">노래책 설명서</button>
        <button class="tab-btn" data-section="price">가격표</button>
        <button class="tab-btn" data-section="songs">노래목록</button>
      </div>

      <input type="text" id="searchInput" placeholder="가수 또는 제목 검색" style="display:none;" />

      <div id="manual" class="section">
• 노래 신청을 할땐 꼭!!! 가수와 곡 제목을 함께 적어서 신청해주세요.
(코드도 적어주시면 감사합니다!)
• 컨디션에 따라 부르기 어렵다고 판단 될 경우 신청곡을 거절 할 수도 있습니다.
(거절 당한 신청은 기본 노래 2곡으로 대체 가능 합니다.)
• 설명을 읽지 않고 신청할 경우 책임은 신청자에게 있습니다.
• 추천 곡은 디스코드 노래 추천방에 적어주세요.

❌ 과도한 평가와 훈수는 자제 해주세요 ❌
      </div>

      <div id="price" class="section" style="display:none;">
• 기본 노래 신청은 2000치즈 혹은 투네이션으로 신청 가능합니다.
• 어려운 노래 신청은 5000치즈 혹은 투네이션으로 신청 가능합니다.
• 유료곡 노래 신청은 10000치즈 이상 혹은 투네이션으로 신청 가능합니다.
• 개인 소장 노래 녹음본 (믹싱 유무 선택 가능)은 200,000치즈 혹은 투네이션으로 신청 가능합니다.
      </div>

      <div id="songs" class="section" style="display:none;">
        <div id="categorySelector">
          <button class="category-btn active" data-category="전체">전체</button>
          <button class="category-btn" data-category="Kpop">K-pop</button>
          <button class="category-btn" data-category="Kpop 아이돌">K-pop 아이돌</button>
          <button class="category-btn" data-category="Pop">Pop</button>
        </div>

        <div id="initialButtons"></div>

        <table id="songTable" style="display:none;">
          <thead>
            <tr>
              <th>가수</th>
              <th>제목</th>
              <th>코드</th>
              <th>난이도</th>
              <th>숙련도</th>
            </tr>
          </thead>
          <tbody id="songList"></tbody>
        </table>

        <p id="noResult" style="display:none;">검색 결과가 없습니다. 추천 곡은 디스코드 노래 추천방에 적어주세요.</p>
      </div>
    </div>

    <!-- 관리자 영역 -->
    <div id="adminArea" style="display:none;">
      <input type="text" id="adminSearchInput" placeholder="가수 또는 제목 검색" style="width:100%; max-width: 300px; margin-bottom: 20px;" />
      <form id="adminForm" onsubmit="return false;" style="display:flex; flex-wrap:wrap; justify-content:center; gap:12px; align-items:center; text-align:right;">
        <label for="adminCategory">카테고리</label>
        <select id="adminCategory" style="max-width:150px;">
          <option value="Kpop">K-pop</option>
          <option value="Kpop 아이돌">K-pop 아이돌</option>
          <option value="Pop">Pop</option>
        </select>

        <label for="adminInitial">초성</label>
        <select id="adminInitial" style="max-width:150px;">
          <option value="ㄱ">ㄱ</option><option value="ㄴ">ㄴ</option><option value="ㄷ">ㄷ</option><option value="ㄹ">ㄹ</option><option value="ㅁ">ㅁ</option>
          <option value="ㅂ">ㅂ</option><option value="ㅅ">ㅅ</option><option value="ㅇ">ㅇ</option><option value="ㅈ">ㅈ</option><option value="ㅊ">ㅊ</option>
          <option value="ㅋ">ㅋ</option><option value="ㅌ">ㅌ</option><option value="ㅍ">ㅍ</option><option value="ㅎ">ㅎ</option>
          <option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option>
          <option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option>
          <option value="K">K</option><option value="L">L</option><option value="M">M</option><option value="N">N</option><option value="O">O</option>
          <option value="P">P</option><option value="Q">Q</option><option value="R">R</option><option value="S">S</option><option value="T">T</option>
          <option value="U">U</option><option value="V">V</option><option value="W">W</option><option value="X">X</option><option value="Y">Y</option>
          <option value="Z">Z</option>
        </select>

        <label for="adminSinger">가수</label>
        <input type="text" id="adminSinger" autocomplete="off" style="max-width:200px;" />

        <label for="adminTitle">제목</label>
        <input type="text" id="adminTitle" autocomplete="off" style="max-width:200px;" />

        <label for="adminKey">코드</label>
        <input type="text" id="adminKey" autocomplete="off" style="max-width:100px;" />

        <label for="adminDifficulty">난이도</label>
        <input type="text" id="adminDifficulty" autocomplete="off" style="max-width:100px;" />

        <label for="adminSkill">숙련도</label>
        <input type="text" id="adminSkill" autocomplete="off" style="max-width:100px;" />
      </form>

      <div id="adminButtons">
        <button id="adminSaveBtn">수정 및 저장</button>
        <button id="adminExitBtn">관리자 모드 종료</button>
      </div>

      <table id="adminSongTable" style="margin-top:20px; width:100%; border-collapse: collapse;">
        <thead>
          <tr style="background:#222;">
            <th>카테고리</th>
            <th>초성</th>
            <th>가수</th>
            <th>제목</th>
            <th>코드</th>
            <th>난이도</th>
            <th>숙련도</th>
          </tr>
        </thead>
        <tbody id="adminSongList"></tbody>
      </table>

      <p id="adminNoResult" style="display:none; color:#ff6f00; text-align:center; margin-top:10px;">검색 결과가 없습니다.</p>
    </div>
  </div>

<script>
  // 노래 데이터 (예시)
  let songs = [
    {category:'Kpop 아이돌', initial:'ㅋ', singer:'큐더블유이알(QWER)', title:'가짜아이돌', key:'Fm', difficulty:'', skill:'완벽 카피X'},
    {category:'Kpop', initial:'ㅇ', singer:'아이유', title:'밤편지', key:'C', difficulty:'하', skill:'상'},
    {category:'Pop', initial:'A', singer:'Adele', title:'Hello', key:'Am', difficulty:'상', skill:'상'},
    {category:'Kpop 아이돌', initial:'ㅇ', singer:'오마이걸', title:'Dun Dun Dance', key:'E', difficulty:'중', skill:'중'},
    {category:'Kpop', initial:'ㄴ', singer:'뉴진스', title:'Hype Boy', key:'D', difficulty:'중', skill:'중'},
    {category:'Kpop 아이돌', initial:'ㅂ', singer:'방탄소년단', title:'Dynamite', key:'G', difficulty:'중', skill:'중'},
  ];

  // DOM 참조
  const manual = document.getElementById('manual');
  const price = document.getElementById('price');
  const songsSection = document.getElementById('songs');
  const searchInput = document.getElementById('searchInput');
  const categoryButtons = document.querySelectorAll('.category-btn');
  const initialButtonsDiv = document.getElementById('initialButtons');
  const songTable = document.getElementById('songTable');
  const songList = document.getElementById('songList');
  const noResult = document.getElementById('noResult');
  const tabButtons = document.querySelectorAll('.tab-btn');

  // 관리자 관련
  const adminToggleBtn = document.getElementById('adminToggleBtn');
  const adminArea = document.getElementById('adminArea');
  const mainUI = document.getElementById('mainUI');

  const adminSearchInput = document.getElementById('adminSearchInput');
  const adminCategory = document.getElementById('adminCategory');
  const adminInitial = document.getElementById('adminInitial');
  const adminSinger = document.getElementById('adminSinger');
  const adminTitle = document.getElementById('adminTitle');
  const adminKey = document.getElementById('adminKey');
  const adminDifficulty = document.getElementById('adminDifficulty');
  const adminSkill = document.getElementById('adminSkill');
  const adminSongList = document.getElementById('adminSongList');
  const adminNoResult = document.getElementById('adminNoResult');
  const adminSaveBtn = document.getElementById('adminSaveBtn');
  const adminExitBtn = document.getElementById('adminExitBtn');

  // 현재 상태
  let currentCategory = '전체';
  let currentInitial = '전체';
  let currentTab = 'manual';
  let currentEditingIndex = null; // 관리자 모드 편집 중인 인덱스

  // 한글 초성 목록 + 영어 A-Z
  const initialsList = ['ㄱ','ㄴ','ㄷ','ㄹ','ㅁ','ㅂ','ㅅ','ㅇ','ㅈ','ㅊ','ㅋ','ㅌ','ㅍ','ㅎ',
                       'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];

  // --- 탭 전환 ---
  tabButtons.forEach(btn=>{
    btn.addEventListener('click', () => {
      // 탭 버튼 스타일 조정
      tabButtons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      // 섹션 표시 변경
      const section = btn.dataset.section;
      currentTab = section;
      manual.style.display = 'none';
      price.style.display = 'none';
      songsSection.style.display = 'none';
      searchInput.style.display = 'none';
      songTable.style.display = 'none';
      noResult.style.display = 'none';
      if(section === 'manual') manual.style.display = 'block';
      else if(section === 'price') price.style.display = 'block';
      else if(section === 'songs') {
        songsSection.style.display = 'block';
        searchInput.style.display = 'inline-block';
        songTable.style.display = 'table';
        renderInitialButtons();
        filterAndRenderSongs();
      }
    });
  });

  // 홈 제목 클릭 시 설명서 탭으로
  document.getElementById('title').addEventListener('click', () => {
    tabButtons.forEach(b=>b.classList.remove('active'));
    tabButtons[0].classList.add('active');
    currentTab = 'manual';
    manual.style.display = 'block';
    price.style.display = 'none';
    songsSection.style.display = 'none';
    searchInput.style.display = 'none';
  });

  // --- 카테고리 버튼 이벤트 ---
  categoryButtons.forEach(btn=>{
    btn.addEventListener('click', () => {
      categoryButtons.forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      currentCategory = btn.dataset.category;
      currentInitial = '전체';
      renderInitialButtons();
      filterAndRenderSongs();
    });
  });

  // --- 초기(초성) 버튼 렌더링 ---
  function renderInitialButtons() {
    initialButtonsDiv.innerHTML = '';
    let initials = ['전체'];
    if(currentCategory === '전체') {
      initials = ['전체'];
    } else if (currentCategory === 'Pop') {
      // 영어 알파벳만
      initials = ['전체'].concat(initialsList.filter(ch => ch >= 'A' && ch <= 'Z'));
    } else {
      // 한글 초성만
      initials = ['전체'].concat(initialsList.filter(ch => ch.charCodeAt(0) >= 0x3131 && ch.charCodeAt(0) <= 0x314E));
    }
    initials.forEach(initial=>{
      const btn = document.createElement('button');
      btn.textContent = initial;
      btn.className = 'initial-btn';
      if(initial === currentInitial) btn.classList.add('active');
      btn.style.margin = '3px';
      btn.addEventListener('click', () => {
        currentInitial = initial;
        document.querySelectorAll('.initial-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        filterAndRenderSongs();
      });
      initialButtonsDiv.appendChild(btn);
    });
  }

  // --- 노래 필터링 및 렌더링 ---
  function filterAndRenderSongs() {
    let searchVal = searchInput.value.trim().toLowerCase();

    // 필터링
    let filtered = songs.filter(s => {
      // 카테고리 필터
      if(currentCategory !== '전체' && s.category !== currentCategory) return false;

      // 초성 필터
      if(currentInitial !== '전체' && s.initial !== currentInitial) return false;

      // 검색 필터 (가수 또는 제목 포함)
      if(searchVal.length > 0) {
        let singerLower = s.singer.toLowerCase();
        let titleLower = s.title.toLowerCase();
        if(!singerLower.includes(searchVal) && !titleLower.includes(searchVal)) return false;
      }
      return true;
    });

    // 노래 목록 렌더링
    songList.innerHTML = '';
    if(filtered.length === 0) {
      noResult.style.display = 'block';
      songTable.style.display = 'none';
      return;
    }
    noResult.style.display = 'none';
    songTable.style.display = 'table';

    filtered.forEach(song=>{
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${song.singer}</td>
        <td>${song.title}</td>
        <td>${song.key}</td>
        <td>${song.difficulty}</td>
        <td>${song.skill}</td>
      `;
      songList.appendChild(tr);
    });
  }

  // --- 검색 이벤트 ---
  searchInput.addEventListener('input', () => {
    filterAndRenderSongs();
  });

  // --- 관리자 토글 ---
  adminToggleBtn.addEventListener('click', () => {
    if(adminArea.style.display === 'none') {
      adminArea.style.display = 'block';
      mainUI.style.display = 'none';
      adminToggleBtn.textContent = '관리자 모드 종료';
      renderAdminSongTable();
    } else {
      adminArea.style.display = 'none';
      mainUI.style.display = 'block';
      adminToggleBtn.textContent = '관리자 모드';
    }
  });

  // 관리자 노래 목록 렌더링
  function renderAdminSongTable(filter='') {
    adminSongList.innerHTML = '';
    let filtered = songs.filter(s=>{
      if(filter === '') return true;
      let f = filter.toLowerCase();
      return s.singer.toLowerCase().includes(f) || s.title.toLowerCase().includes(f);
    });
    if(filtered.length === 0) {
      adminNoResult.style.display = 'block';
      return;
    } else {
      adminNoResult.style.display = 'none';
    }

    filtered.forEach((song, idx)=>{
      const tr = document.createElement('tr');
      tr.style.cursor = 'pointer';
      tr.innerHTML = `
        <td>${song.category}</td>
        <td>${song.initial}</td>
        <td>${song.singer}</td>
        <td>${song.title}</td>
        <td>${song.key}</td>
        <td>${song.difficulty}</td>
        <td>${song.skill}</td>
      `;
      tr.addEventListener('click', () => {
        currentEditingIndex = idx;
        fillAdminForm(song);
      });
      adminSongList.appendChild(tr);
    });
  }

  // 관리자 검색 필터
  adminSearchInput.addEventListener('input', () => {
    renderAdminSongTable(adminSearchInput.value.trim());
  });

  // 관리자 폼 채우기
  function fillAdminForm(song) {
    adminCategory.value = song.category;
    adminInitial.value = song.initial;
    adminSinger.value = song.singer;
    adminTitle.value = song.title;
    adminKey.value = song.key;
    adminDifficulty.value = song.difficulty;
    adminSkill.value = song.skill;
  }

  // 관리자 저장 버튼 클릭
  adminSaveBtn.addEventListener('click', () => {
    if(currentEditingIndex === null) {
      alert('수정할 노래를 선택해주세요.');
      return;
    }
    // 수정 내용 가져오기
    let updatedSong = {
      category: adminCategory.value,
      initial: adminInitial.value,
      singer: adminSinger.value.trim(),
      title: adminTitle.value.trim(),
      key: adminKey.value.trim(),
      difficulty: adminDifficulty.value.trim(),
      skill: adminSkill.value.trim(),
    };
    // 가수명과 제목 필수 검사
    if(updatedSong.singer === '' || updatedSong.title === '') {
      alert('가수명과 제목을 반드시 입력해주세요.');
      return;
    }
    // 배열 업데이트
    songs[currentEditingIndex] = updatedSong;

    // 관리자 목록과 기본 목록 갱신
    renderAdminSongTable(adminSearchInput.value.trim());
    filterAndRenderSongs();

    alert('수정 및 저장 완료!');
  });

  // 관리자 종료 버튼
  adminExitBtn.addEventListener('click', () => {
    adminArea.style.display = 'none';
    mainUI.style.display = 'block';
    adminToggleBtn.textContent = '관리자 모드';
  });

  // 페이지 초기화
  renderInitialButtons();
  filterAndRenderSongs();

</script>
</body>
</html>
